<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Menu Items</title>
    <link rel="stylesheet" href="/css/main.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
    <!-- Google Fonts -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&display=swap">
    <!-- Bootstrap core CSS -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/css/bootstrap.min.css" rel="stylesheet">
    <!-- Material Design Bootstrap -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" rel="stylesheet">
</head>
<body>
<nav class="navbar fixed-top navbar-expand-lg navbar-light white scrolling-navbar">
    <div class="container">

        <!-- Brand -->
        <a class="navbar-brand pt-0 waves-effect" href="/">
            Diner Menu Digitization With OCR
        </a>
    </div>

</nav>
<div class="column">
    <div th:if="${filenames}">
        <div class="slideshow-container">

            <th:block th:each="filename : ${filenames}">
                <div class="mySlides fade">
                    <img th:src="${'/imagesWithBoundingBoxes/' + filename}" style="width:100%">
                </div>

                <!-- Next and previous buttons -->
                <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
                <a class="next" onclick="plusSlides(1)">&#10095;</a>

            </th:block>
        </div>
    </div>


    <!--
    <img style="width: 100%;" th:src="${'/imagesWithBoundingBoxes/' + filename}"></img>
    -->
</div>
<div class="column">
<div th:if="${menu}">

    <th:block th:each="category : ${menu.menuCategories}">
        <th:block th:each="dish : ${category.dishes}">
            <div class="example-parent">
                <div
                        class="example-origin"
                >
                    Category
                    <div
                            class="example-draggable"
                    >
                        <select th:value="${dish.categoryID}" th:id="${dish.dishID + 'category'}" name="category" class="form-control">
                            <th:block th:each="category : ${menu.menuCategories}">
                                <div th:if= "${category.categoryID == dish.categoryID}">
                                    <option selected th:value="${category.categoryID}" th:text="${category.name}"></option>
                                </div>
                                <div th:if= "${category.categoryID != dish.categoryID}">
                                    <option th:value="${category.categoryID}" th:text="${category.name}"></option>
                                </div>
                            </th:block>
                        </select>
                    </div>
                </div>

                <div
                        th:id="${dish.dishID+'name'}"
                        class="example-dropzone"
                        ondragover="onDragOver(event);"
                        ondrop="onDrop(event);"
                >
                    Name
                    <div
                            class="example-draggable"
                            draggable="true"
                            ondragstart="onDragStart(event);"
                            contenteditable="true"
                            th:id = "${dish.dishID + dish.name}"
                            th:text="${dish.name}"
                            th:value="${dish.name}"
                    >

                    </div>

                </div>
                <div
                        th:id="${dish.dishID + 'description'}"
                        class="example-dropzone"
                        ondragover="onDragOver(event);"
                        ondrop="onDrop(event);"
                >
                    Description
                    <div
                            class="example-draggable"
                            draggable="true"
                            ondragstart="onDragStart(event);"
                            contenteditable="true"
                            th:text="${dish.description}"
                            th:value="${dish.description}"
                            th:id="${dish.dishID + dish.description}"
                    >
                    </div>
                </div>
                <div
                        th:id="${dish.dishID + 'price'}"
                        class="example-dropzone"
                        ondragover="onDragOver(event);"
                        ondrop="onDrop(event);"
                >
                    Price
                    <div
                            class="example-draggable"
                            draggable="true"
                            ondragstart="onDragStart(event);"
                            contenteditable="true"
                            th:id="${dish.dishID + dish.name + dish.price}"
                            th:text="${dish.price}"
                            th:value="${dish.price}"
                    >
                    </div>
                </div>
                <div
                        class="example-origin"
                >
                    Actions<br>
                    <div class="container">
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <button class="btn btn-warning" th:data-dish-id="${dish.dishID}" th:data-menu-id="${menuId}" th:data-category-object="${dish.dishID + 'category'}" th:data-name-object="${dish.dishID+'name'}" th:data-description-object="${dish.dishID + 'description'}" th:data-price-object="${dish.dishID + 'price'}"  onclick="fillTheForm(this)">Update</button>
                        </div>
                        <div class="col-lg-6 col-md-6 col-sm-6">
                            <button class="btn btn-danger" th:data-dish-id="${dish.dishID}" th:data-menu-id="${menuId}" onclick="removeItem(this)">Remove</button>
                        </div>
                    </div>
                </div>
            </div>
        </th:block>
        <!-- This is our clonable table line -->
    </th:block>
</div>
</div>
<form id="updateForm" action="/edit-menu-item" method="post" enctype="multipart/form-data">
    <input name="menuId" type="text" id="menuId" style="display:none;" th:value="${menuId}" \>
    <input name = "dishId" type="text" id="id" style="display: none;" \>
    <input name = "category" type="text" id="categoryId" style="display: none;" \>
    <input name = "name" type="text" id="item-name" style="display: none;" \>
    <input name = "description" type="text" id="item-description" style="display: none;" \>
    <input name = "price" type="text" id="item-price" style="display: none;" \>
    <input name = "filenames" type="text" th:value="${filenames}" \>
</form>
<form id="deleteForm" action="/delete-menu-item" style="display: none;" method="post" enctype="multipart/form-data">
    <input name = "dishId" id="deletedDishId" type="text" style="display: none;" \>
    <input name="menuId" type="text" style="display:none;" th:value="${menuId}" \>
    <input name = "filenames" type="text" th:value="${filenames}" \>
</form>
<script>
     var slideIndex = 1;
    showSlides(slideIndex);

    function plusSlides(n) {
      showSlides(slideIndex += n);
    }

    function currentSlide(n) {
      showSlides(slideIndex = n);
    }

    function showSlides(n) {
      var i;
      var slides = document.getElementsByClassName("mySlides");
      if (n > slides.length) {slideIndex = 1}
      if (n < 1) {slideIndex = slides.length}
      for (i = 0; i < slides.length; i++) {
          slides[i].style.display = "none";
      }

      slides[slideIndex-1].style.display = "block";
    }
</script>
<script type="text/javascript" src="/js/drag-n-drop.js"></script>
<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.5.0/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js"></script>

</body>
</html>